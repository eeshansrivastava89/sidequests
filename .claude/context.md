# Session Context
<!-- Auto-generated by /context-save -->
<!-- Last saved: 2026-02-07 -->

## Project Anchor

**Project:** Projects Dashboard v2 — local web app scanning ~/dev as a "daily starting point" for developers
**Current Phase:** All 21 phases complete. Awaiting Codex code review feedback.

## Git State

**Branch:** main
**Last Commit:** c1fbb87 docs: mark all 21 phases complete, rewrite PITCH.md, add rawJsonHash migration
**Uncommitted Changes:** None (clean working tree)

## Recent Commits (this session)

| Commit | Content |
|--------|---------|
| `4e5b11e` | phase 11+13: enhanced scan pipeline and compact list view (prior session) |
| `5ca809b` | phases 12-16: schema evolution, derive v2, sort/filter, drawer redesign, API merge updates |
| `e60aa57` | phases 17-19: enhanced quick actions, project pinning, pipeline optimizations |
| `adb6556` | phases 20-21: session memory, activity timeline, docs update |
| `c1fbb87` | docs: mark all 21 phases complete, rewrite PITCH.md, add rawJsonHash migration |

## What We Did

### All 21 Phases Complete
Phases 11-21 implemented using agent teams (parallel Tmux agents). Waves:
- **Wave A** (prior session): Phase 11 (scan.py 15 new fields) + Phase 13 (compact list view)
- **Wave B+C** (this session): Phases 12-16 (schema evolution, derive v2, sort/filter, drawer redesign, API merge)
- **Wave D** (this session): Phases 17-19 (quick actions, pinning, pipeline optimizations)
- **Wave E+F** (this session): Phases 20-21 (session memory, activity timeline, docs)

### Issues Resolved This Session
1. **Memory leak crash** — Prior session crashed at 97% RAM. Root cause: orphaned Claude agent processes from Tmux teams not getting cleaned up on force-kill. Killed orphan PID 82263, cleaned stale team/task dirs.
2. **Orphan Next.js dev server** — Found running from 12:28 AM eating 750MB. Killed PIDs 38454/38477/38478/39731.
3. **Missing migration** — Phase 19 added `rawJsonHash` to Prisma schema but no migration was run. Dashboard crashed with `no such column: main.Scan.rawJsonHash`. Fixed with `prisma migrate dev --name add_raw_json_hash`.

## Decisions Made

| Decision | Rationale |
|----------|-----------|
| Use Opus for agents, not Sonnet | User's preference — their money, their session. Memory issue was orphan processes, not model size. |
| Clean up defensive scanAny casts | Phase 15 agent coded defensively against Phase 16; once both landed, switched to top-level Project fields |
| PITCH.md full rewrite | Repositioned from "bird's-eye view" to "daily starting point" to match the Phase 11-21 transformation |

## Working Model

- **Claude (me):** Implementer — writes code, runs agent teams
- **Codex:** Architect and code reviewer — reviews work, provides feedback
- User mediates between the two

## Next Actions

1. **Receive Codex code review feedback** — user will bring it next session
2. **Address review findings** — implement whatever Codex flags
3. **Visual QA** — user was about to test the dashboard when session ended

## Conversation Essence

- Session started with crash recovery and orphan cleanup
- Agent teams work well but need graceful shutdown — orphan processes are the real memory risk, not model size
- User explicitly wants Opus for agents, not Sonnet — don't downgrade without asking
- All docs updated: IMPLEMENTATION_PLAN (all ✅), ARCHITECTURE.md (comprehensive), PITCH.md (rewritten), README.md (updated)
- .env.local.example updated with LLM_CONCURRENCY=3